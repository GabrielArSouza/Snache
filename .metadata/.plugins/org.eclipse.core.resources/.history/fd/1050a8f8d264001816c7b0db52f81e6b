package socket;

import controller.EnumSnakeDirection;
import controller.SharedSnakeDirection;
import domain.Snake;

/**
 * This class contains information about a single player connected to the game.
 */
public class ClientInfo
{
	/** The max number of time steps that the player may not respond to the server.*/
	private final int MAX_ITERATIONS = 3;

	/** The dead cont. */
	private int deadCont;

	/** The shared snake direction. */
	private SharedSnakeDirection sharedSnakeDirection;

	/** The direction updated. */
	private boolean directionUpdated;

	/** The snake. */
	private Snake snake;

	/**
	 * Instantiates a new client info.
	 *
	 * @param sharedSnakeDirection
	 *            the shared snake direction
	 * @param snake
	 *            the snake
	 */
	public ClientInfo(SharedSnakeDirection sharedSnakeDirection, Snake snake)
	{
		this.sharedSnakeDirection = sharedSnakeDirection;
		deadCont = MAX_ITERATIONS;
		directionUpdated = false;
		this.snake = snake;
	}

	/**
	 * Gets the snake.
	 *
	 * @return the snake
	 */
	public Snake getSnake()
	{
		return snake;
	}

	/**
	 * Checks if is active.
	 *
	 * @return true, if is active
	 */
	public boolean isActive()
	{
		return deadCont != 0;
	}

	/**
	 * Decrease dead cont.
	 */
	public void decreaseDeadCont()
	{
		--deadCont;
	}

	/**
	 * Update direction.
	 *
	 * @param direction
	 *            the direction
	 */
	public void updateDirection(String direction)
	{
		if(direction.equals(EnumSnakeDirection.SAME.toString()) || directionUpdated)
		{
			return;
		}

		else
		{
			System.out.println("updating snake direction to " + direction + "...");
			directionUpdated = true;
			sharedSnakeDirection.produce(direction);
			deadCont = MAX_ITERATIONS;
		}

	}

	/**
	 * Sets the direction updated.
	 *
	 * @param directionUpdated
	 *            the new direction updated
	 */
	public void setDirectionUpdated(boolean directionUpdated)
	{
		this.directionUpdated = directionUpdated;
	}
}
