package domain;

import java.util.ArrayList;
import java.util.List;

import controller.EnumSnakeDirection;

/**
 * The class Snake represents a snake on the logic board.
 */
public class Snake
{
	
	/**  number of SnakePiece objects in the List<SnakePiece> object. */
	private int bodySize;

	/** The head of the snake. */
	private SnakePiece head;

	/** The body of the snake (including tail). */
	private List<SnakePiece> body;

	/** The current direction of the snake. */
	private EnumSnakeDirection direction;

	/** The id of the snake. */
	private long id;

	/**
	 * Instantiates a new snake. The snake body is built from a head position and a
	 * size only, meaning that the snake is, initially, contiguous
	 *
	 * @param headRow
	 *            the row of the snake on the board
	 * @param headColumn
	 *            the column of the snake on the board
	 * @param bodySize
	 *            the size of the body of the snake
	 * @param initialDirection
	 *            the initial direction of the snake
	 * @param id
	 *            the id of the snake
	 */
	public Snake(int headRow, int headColumn, int bodySize, EnumSnakeDirection initialDirection, long id)
	{
		this.id = id;
		this.head = new SnakePiece(headRow, headColumn);
		this.bodySize = bodySize;

		initBody(initialDirection);
	}

	/**
	 * Inits the body.
	 *
	 * @param initialDirection the initial direction
	 */
	private void initBody(EnumSnakeDirection initialDirection)
	{
		this.body = new ArrayList<SnakePiece>();

		for(int i = 0; i < bodySize; ++i)
		{
			if(initialDirection == EnumSnakeDirection.LEFT)
			{
				body.add(new SnakePiece(headRow, headColumn + i + 1));
			}

			else if(initialDirection == EnumSnakeDirection.RIGHT)
			{
				body.add(new SnakePiece(headRow, headColumn - i - 1));
			}

			else if(initialDirection == EnumSnakeDirection.DOWN)
			{
				body.add(new SnakePiece(headRow - i - 1, headColumn));
			}

			else if(initialDirection == EnumSnakeDirection.UP)
			{
				body.add(new SnakePiece(headRow + i + 1, headColumn));
			}

			this.direction = initialDirection;
		}
	}

	/**
	 * Move.
	 */
	public void move()
	{
		// Iniciar nova cabeça
		SnakePiece newHead = null;

		// Mover Cabeça
		if(direction == EnumSnakeDirection.UP)
			newHead = new SnakePiece((head.getRow() - 1), head.getColumn());
		else if(direction == EnumSnakeDirection.DOWN)
			newHead = new SnakePiece((head.getRow() + 1), head.getColumn());
		else if(direction == EnumSnakeDirection.LEFT)
			newHead = new SnakePiece(head.getRow(), (head.getColumn() - 1));
		else if(direction == EnumSnakeDirection.RIGHT)
			newHead = new SnakePiece(head.getRow(), (head.getColumn() + 1));

		// Mover Corpo
		for(int i = body.size() - 1; i >= 1; i--)
			body.get(i).copy(body.get(i - 1));

		// Mover primeira posição do corpo
		body.get(0).copy(head);

		head.copy(newHead);
	}

	/**
	 * Gets the head.
	 *
	 * @return the head
	 */
	public SnakePiece getHead()
	{
		return head;
	}

	/**
	 * Gets the body.
	 *
	 * @return the body
	 */
	public List<SnakePiece> getBody()
	{
		return body;
	}

	/**
	 * Gets the direction.
	 *
	 * @return the direction
	 */
	public EnumSnakeDirection getDirection()
	{
		return direction;
	}

	/**
	 * Sets the direction.
	 *
	 * @param direction
	 *            the new direction
	 */
	public void setDirection(EnumSnakeDirection direction)
	{
		this.direction = direction;
	}

	/**
	 * Gets the tail.
	 *
	 * @return the tail
	 */
	public SnakePiece getTail()
	{
		return body.get(bodySize - 1);
	}

	/*
	 * (non-Javadoc)
	 * 
	 * @see java.lang.Object#hashCode()
	 */
	@Override
	public int hashCode()
	{
		return Long.hashCode(id);
	}

	/*
	 * (non-Javadoc)
	 * 
	 * @see java.lang.Object#toString()
	 */
	public String toString()
	{
		String res = "";
		res += "[" + head.getRow() + ", " + head.getColumn() + "], ";

		for(SnakePiece p : body)
		{
			res += "[" + p.getRow() + ", " + p.getColumn() + "], ";
		}

		return res;
	}

	/*
	 * (non-Javadoc)
	 * 
	 * @see java.lang.Object#equals(java.lang.Object)
	 */
	@Override
	public boolean equals(Object obj)
	{
		if(this == obj)
			return true;
		if(obj == null)
			return false;
		if(getClass() != obj.getClass())
			return false;
		Snake other = (Snake) obj;

		return id == other.id;
	}
}
